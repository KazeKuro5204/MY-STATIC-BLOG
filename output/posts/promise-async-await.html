<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Promise, Async/Await trong JavaScript</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">
  <nav class="navbar navbar-dark bg-dark">
    <div class="container">
      <a href="../index.html" class="navbar-brand">My Dev Blog</a>
      <a href="../blog.html" class="text-white">Blog</a>
    </div>
  </nav>
  <div class="container mt-5">
    <h1>Promise, Async/Await trong JavaScript</h1>
    <p><span class="badge bg-secondary">JavaScript</span> <span class="badge bg-danger">Bất đồng bộ</span></p>
    <div>
        <p>JavaScript là ngôn ngữ đơn luồng (single-threaded), nhưng nó có thể xử lý các tác vụ mất thời gian (như fetch API) bằng cách sử dụng cơ chế bất đồng bộ. **Promise** và **async/await** là giải pháp cốt lõi cho vấn đề này.</p>
        
        <h2 class="mt-4">1. Promise: Quản lý kết quả bất đồng bộ</h2>
        <p>Một Promise là một đối tượng đại diện cho một giá trị có thể có sẵn *bây giờ, sau này*, hoặc *không bao giờ*. Nó giúp chúng ta xử lý thành công (<code>.then()</code>) hoặc thất bại (<code>.catch()</code>) của một thao tác bất đồng bộ một cách rõ ràng.</p>
        <pre class="bg-dark text-white p-3 rounded"><code>
const delay = (ms) => new Promise(resolve => setTimeout(resolve, ms));

delay(1000)
    .then(() => {
        console.log("Đã đợi 1 giây!");
        return delay(500); // Trả về Promise để chuỗi hóa
    })
    .then(() => {
        console.log("Đợi thêm 0.5 giây!");
    })
    .catch(error => {
        console.error("Có lỗi xảy ra:", error);
    });
        </code></pre>

        <h2 class="mt-4">2. Async/Await: Cú pháp đọc được</h2>
        <p><code>async/await</code> được xây dựng trên nền tảng Promise, cho phép bạn viết code bất đồng bộ trông gần như đồng bộ, loại bỏ "Callback Hell" và chuỗi <code>.then()</code> phức tạp.</p>
        <ul class="list-group">
            <li class="list-group-item">Từ khóa **async** phải đặt trước hàm.</li>
            <li class="list-group-item">Từ khóa **await** chỉ dùng bên trong hàm <code>async</code> và nó *tạm dừng* việc thực thi hàm cho đến khi Promise giải quyết xong.</li>
        </ul>
        <pre class="bg-dark text-white p-3 rounded"><code>
async function loadData() {
    try {
        const response = await fetch('/api/user'); // Dừng cho đến khi có response
        const user = await response.json();        // Dừng cho đến khi parse JSON
        console.log("Dữ liệu người dùng:", user);
    } catch (error) {
        console.error("Không tải được dữ liệu:", error);
    }
}
        </code></pre>
    </div>
    <p class="mt-4"><a href="../blog.html">← Quay lại Blog</a></p>
  </div>
</body>
</html>